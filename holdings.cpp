#include "MARCdata.hpp"

void MARCdata::csvOutput(const std::string filename){
	constructSubfields();
	ogzstream table(filename.c_str());
	table << "014a|852b|852h|852t|852z|852x|852a|8522|852p|8521|852i|852j|852n|852g|852q|8668|866a|866z|866x|866b|8666|843a|8538|853a|853b|853u|853v|853w|853x|853i|853y|853j|853k|853z|853g|853l|853h|8638|863a|863i|863z|863b|863j|863k|863x|863g|991a|991d|991f|991e|991c|991g|993a|9938|994a|9948|8548|854a|854b|854i|854z|854j|854k|854u|854v|854w|854x|854l|854g|854y|8558|855a|855i|855b|855x|855j|855k|855w|855v|855z|855u|855o|8658|865a|865i|865z|865x|865j|865b|865k|990a|8678|867a|867z|8676|867x|8648|864a|864z|864b|864i|864x|864j|864k|856u|856y|856z|856a|8568|8563|8688|868a|868z|868x|040a|842a|8868|886a\n";
	for (auto& book : books){
		table << book["014"]['a'] << "|";
		table << book["852"]['b'] << "|";
		table << book["852"]['h'] << "|";
		table << book["852"]['t'] << "|";
		table << book["852"]['z'] << "|";
		table << book["852"]['x'] << "|";
		table << book["852"]['a'] << "|";
		table << book["852"]['2'] << "|";
		table << book["852"]['p'] << "|";
		table << book["852"]['1'] << "|";
		table << book["852"]['i'] << "|";
		table << book["852"]['j'] << "|";
		table << book["852"]['n'] << "|";
		table << book["852"]['g'] << "|";
		table << book["852"]['q'] << "|";
		table << book["866"]['8'] << "|";
		table << book["866"]['a'] << "|";
		table << book["866"]['z'] << "|";
		table << book["866"]['x'] << "|";
		table << book["866"]['b'] << "|";
		table << book["866"]['6'] << "|";
		table << book["843"]['a'] << "|";
		table << book["853"]['8'] << "|";
		table << book["853"]['a'] << "|";
		table << book["853"]['b'] << "|";
		table << book["853"]['u'] << "|";
		table << book["853"]['v'] << "|";
		table << book["853"]['w'] << "|";
		table << book["853"]['x'] << "|";
		table << book["853"]['i'] << "|";
		table << book["853"]['y'] << "|";
		table << book["853"]['j'] << "|";
		table << book["853"]['k'] << "|";
		table << book["853"]['z'] << "|";
		table << book["853"]['g'] << "|";
		table << book["853"]['l'] << "|";
		table << book["853"]['h'] << "|";
		table << book["863"]['8'] << "|";
		table << book["863"]['a'] << "|";
		table << book["863"]['i'] << "|";
		table << book["863"]['z'] << "|";
		table << book["863"]['b'] << "|";
		table << book["863"]['j'] << "|";
		table << book["863"]['k'] << "|";
		table << book["863"]['x'] << "|";
		table << book["863"]['g'] << "|";
		table << book["991"]['a'] << "|";
		table << book["991"]['d'] << "|";
		table << book["991"]['f'] << "|";
		table << book["991"]['e'] << "|";
		table << book["991"]['c'] << "|";
		table << book["991"]['g'] << "|";
		table << book["993"]['a'] << "|";
		table << book["993"]['8'] << "|";
		table << book["994"]['a'] << "|";
		table << book["994"]['8'] << "|";
		table << book["854"]['8'] << "|";
		table << book["854"]['a'] << "|";
		table << book["854"]['b'] << "|";
		table << book["854"]['i'] << "|";
		table << book["854"]['z'] << "|";
		table << book["854"]['j'] << "|";
		table << book["854"]['k'] << "|";
		table << book["854"]['u'] << "|";
		table << book["854"]['v'] << "|";
		table << book["854"]['w'] << "|";
		table << book["854"]['x'] << "|";
		table << book["854"]['l'] << "|";
		table << book["854"]['g'] << "|";
		table << book["854"]['y'] << "|";
		table << book["855"]['8'] << "|";
		table << book["855"]['a'] << "|";
		table << book["855"]['i'] << "|";
		table << book["855"]['b'] << "|";
		table << book["855"]['x'] << "|";
		table << book["855"]['j'] << "|";
		table << book["855"]['k'] << "|";
		table << book["855"]['w'] << "|";
		table << book["855"]['v'] << "|";
		table << book["855"]['z'] << "|";
		table << book["855"]['u'] << "|";
		table << book["855"]['o'] << "|";
		table << book["865"]['8'] << "|";
		table << book["865"]['a'] << "|";
		table << book["865"]['i'] << "|";
		table << book["865"]['z'] << "|";
		table << book["865"]['x'] << "|";
		table << book["865"]['j'] << "|";
		table << book["865"]['b'] << "|";
		table << book["865"]['k'] << "|";
		table << book["990"]['a'] << "|";
		table << book["867"]['8'] << "|";
		table << book["867"]['a'] << "|";
		table << book["867"]['z'] << "|";
		table << book["867"]['6'] << "|";
		table << book["867"]['x'] << "|";
		table << book["864"]['8'] << "|";
		table << book["864"]['a'] << "|";
		table << book["864"]['z'] << "|";
		table << book["864"]['b'] << "|";
		table << book["864"]['i'] << "|";
		table << book["864"]['x'] << "|";
		table << book["864"]['j'] << "|";
		table << book["864"]['k'] << "|";
		table << book["856"]['u'] << "|";
		table << book["856"]['y'] << "|";
		table << book["856"]['z'] << "|";
		table << book["856"]['a'] << "|";
		table << book["856"]['8'] << "|";
		table << book["856"]['3'] << "|";
		table << book["868"]['8'] << "|";
		table << book["868"]['a'] << "|";
		table << book["868"]['z'] << "|";
		table << book["868"]['x'] << "|";
		table << book["040"]['a'] << "|";
		table << book["842"]['a'] << "|";
		table << book["886"]['8'] << "|";
		table << book["886"]['a'] << "\n";
	}
}

int main()
{
	MARCdata holdings;
	holdings.xmlInput("data/holdings.xml");
	holdings.csvOutput("data/holdings.csv.gz");
	return 0;
}
